"use strict";(self.webpackChunkqtrobot_documentation=self.webpackChunkqtrobot_documentation||[]).push([[8793],{68899:function(t,e,o){o.r(e),o.d(e,{frontMatter:function(){return p},contentTitle:function(){return u},metadata:function(){return c},toc:function(){return d},default:function(){return h}});var n=o(87462),r=o(63366),a=(o(67294),o(3905)),i=o(18477),l=o(14702),s=["components"],p={id:"python_ros_moveit",title:"Controlling QTrobot arms using MoveIt",hide_table_of_contents:!0},u=void 0,c={unversionedId:"tutorials/python/python_ros_moveit",id:"tutorials/python/python_ros_moveit",isDocsHomePage:!1,title:"Controlling QTrobot arms using MoveIt",description:"signalcellularalt &nbsp;Level:&nbsp; Advanced",source:"@site/docs/tutorials/python/python_ros_moveit.md",sourceDirName:"tutorials/python",slug:"/tutorials/python/python_ros_moveit",permalink:"/docs/tutorials/python/python_ros_moveit",tags:[],version:"current",frontMatter:{id:"python_ros_moveit",title:"Controlling QTrobot arms using MoveIt",hide_table_of_contents:!0},sidebar:"code_tutorials_sidebar",previous:{title:"Offline speech recognition",permalink:"/docs/tutorials/python/python_ros_vosk"},next:{title:"Create a ROS C++ project",permalink:"/docs/tutorials/cpp/cpp_ros_project"}},d=[{value:"Preparation and requirements",id:"preparation-and-requirements",children:[{value:"QTrobot setup",id:"qtrobot-setup",children:[],level:3},{value:"Your machine setup (QTPC)",id:"your-machine-setup-qtpc",children:[],level:3}],level:2},{value:"Build the motors_moveit",id:"build-the-motors_moveit",children:[],level:2},{value:"How to run the examples",id:"how-to-run-the-examples",children:[{value:"Drawing rectangle",id:"drawing-rectangle",children:[],level:3},{value:"Drawing spiral",id:"drawing-spiral",children:[],level:3}],level:2}],m={toc:d};function h(t){var e=t.components,o=(0,r.Z)(t,s);return(0,a.kt)("wrapper",(0,n.Z)({},m,o,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Overview")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)(i.Z,{mdxType:"Icon"},"signal_cellular_alt")," ",(0,a.kt)(l.Z,{mdxType:"Markdown"},"\xa0**Level:**\xa0 *Advanced*"),(0,a.kt)("br",null)," ",(0,a.kt)(i.Z,{mdxType:"Icon"}," track_changes ")," ",(0,a.kt)(l.Z,{mdxType:"Markdown"},"\xa0**Goal:**\xa0 *learn how to control QTrobot arms using MoveIt*"),(0,a.kt)("br",null)," ",(0,a.kt)(i.Z,{mdxType:"Icon"}," task_alt ")," ",(0,a.kt)(l.Z,{mdxType:"Markdown"},"\xa0**Requirements:**"),(0,a.kt)("ul",{parentName:"div"},(0,a.kt)("li",{parentName:"ul"},"\xa0","\xa0",(0,a.kt)("a",{parentName:"li",href:"/docs/intro_code"},"Quick start with coding on QTrobot")),(0,a.kt)("li",{parentName:"ul"},"\xa0","\xa0",(0,a.kt)("a",{parentName:"li",href:"/docs/tutorials/python/python_ros_project"},"Create a ROS python project"))))),(0,a.kt)("p",null,"This advanced tutorial demonstrate how to use ROS MoveIT to control QTrobot arms. The examples draw some shapes (i,e. rectangle and spirals) on the XY plane in robot frame."),(0,a.kt)("center",null,(0,a.kt)("iframe",{width:"800",height:"480",src:"https://www.youtube.com/embed/JVJMZNkcl6M",frameborder:"0",allow:"accelerometer; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:!0})),(0,a.kt)("h2",{id:"preparation-and-requirements"},"Preparation and requirements"),(0,a.kt)("p",null,"Before running the example, please ensure that following setups of your QTrobot and the machine which you are running the example."),(0,a.kt)("h3",{id:"qtrobot-setup"},"QTrobot setup"),(0,a.kt)("p",null,"By default QTrobot motors interface runs in ",(0,a.kt)("em",{parentName:"p"},"'normal'")," mode. in normal mode, the motors control loop and joints state publisher run in low frequency (2-5Hz). More importantly the joint position values are in ",(0,a.kt)("em",{parentName:"p"},"degree"),". To be able to use MoveIt with QTrobot, you need to configure it to run in ",(0,a.kt)("em",{parentName:"p"},"'advanced'")," mode:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"joints position value is in ",(0,a.kt)("em",{parentName:"li"},"radian")),(0,a.kt)("li",{parentName:"ul"},"motors main controller loop and joints state publisher runs in 30hz."),(0,a.kt)("li",{parentName:"ul"},"required interfaces and controller such as ",(0,a.kt)("inlineCode",{parentName:"li"},"robot_state_publisher")," and ",(0,a.kt)("inlineCode",{parentName:"li"},"JointTrajectoryController")," are available")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Change motor launcher autostart script to run in advanced mode:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"nano ~/robot/autostart/start_qt_motor.sh\n")),(0,a.kt)("p",null,"and change the corresponding line to look like the following and save and exit:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"roslaunch qt_motor qt_motor_advanced.launch\n")),(0,a.kt)("p",null,"Reboot the robot to run the advance motor interface."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Check the advanced mode setup:"),"\nAfter rebooting the reboot, you can check (from QTPC, QTRP or your machine) if the motor interface is running in the advanced mode:"),(0,a.kt)("p",null,"joint state publisher frequency:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"rostopic hz /qt_robot/joints/state\n...\naverage rate: 30.041\n    min: 0.029s max: 0.047s std dev: 0.00391s window: 29\n")),(0,a.kt)("p",null,"joints value should be in radian:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"rostopic echo /qt_robot/joints/state\n...\nposition: [0.015707962851830046, 0.0, -0.6073745663782212, 1.569051024174513, -0.9896016991965904, -0.5689773095185405, -0.3455751785790718, -0.8360127383368947]\n")),(0,a.kt)("p",null,"trajectory controller is running:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"rostopic type  /qt_robot/left_arm_controller/follow_joint_trajectory/goal\n...\ncontrol_msgs/FollowJointTrajectoryActionGoal\n")),(0,a.kt)("h3",{id:"your-machine-setup-qtpc"},"Your machine setup (QTPC)"),(0,a.kt)("p",null,"After checking and updating the QTrobot setup, you can install the iKfast solver plugin for MoveIt on the machine which you plan to run the example:"),(0,a.kt)("p",null,"Get the latest version of QTrobot open software repository"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"cd ~/robot/code/software\ngit pull\n")),(0,a.kt)("p",null,"If the folder doesn't exists:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"cd ~/robot/code/\ngit clone https://github.com/luxai-qtrobot/software.git\n")),(0,a.kt)("p",null,"build the plugins:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"cd ~/catkin_ws/src\nln -s ~/software/plugins/qtrobot_ikfast_right_arm_plugin .\nln -s ~/software/plugins/qtrobot_ikfast_right_left_plugin .\ncd ~/catkin_ws\ncatkin_make\n")),(0,a.kt)("h2",{id:"build-the-motors_moveit"},"Build the motors_moveit"),(0,a.kt)("p",null,"Assuming that you already have the ",(0,a.kt)("inlineCode",{parentName:"p"},"tutorial")," repository (default path ",(0,a.kt)("inlineCode",{parentName:"p"},"~/robot/code/tutorials"),"):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"cd ~/catkin_ws/src\nln -s ~/robot/code/tutorials/examples/motors_moveit ./\ncd ~/catkin_ws\ncatkin_make\n")),(0,a.kt)("p",null,"if you don't have it, then clone it and repeat the above process:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"git clone https://github.com/luxai-qtrobot/tutorials\n")),(0,a.kt)("h2",{id:"how-to-run-the-examples"},"How to run the examples"),(0,a.kt)("p",null,"Launch ",(0,a.kt)("inlineCode",{parentName:"p"},"moveit_qtrobot.launch")," to start move_group planner and rviz:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"roslaunch motors_moveit moveit_qtrobot.launch\n")),(0,a.kt)("p",null,"wait until rviz shows up, then run one of the following demos:"),(0,a.kt)("h3",{id:"drawing-rectangle"},"Drawing rectangle"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"rosrun motors_moveit draw_rectangle.py joint_states:=/qt_robot/joints/state\n")),(0,a.kt)("h3",{id:"drawing-spiral"},"Drawing spiral"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"rosrun motors_moveit draw_spiral.py joint_states:=/qt_robot/joints/state\n")))}h.isMDXComponent=!0}}]);