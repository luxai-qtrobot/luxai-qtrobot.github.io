"use strict";(self.webpackChunkqtrobot_documentation=self.webpackChunkqtrobot_documentation||[]).push([[8599],{599:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>s,metadata:()=>a,toc:()=>d});var o=t(5893),r=t(1151),i=t(9656);const s={id:"python_ros_moveit",title:"Controlling QTrobot arms using MoveIt",hide_table_of_contents:!0},l=void 0,a={id:"tutorials/python/python_ros_moveit",title:"Controlling QTrobot arms using MoveIt",description:"signalcellularalt &nbsp;Level:&nbsp; Advanced",source:"@site/docs/tutorials/python/python_ros_moveit.mdx",sourceDirName:"tutorials/python",slug:"/tutorials/python/python_ros_moveit",permalink:"/docs/tutorials/python/python_ros_moveit",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"python_ros_moveit",title:"Controlling QTrobot arms using MoveIt",hide_table_of_contents:!0},sidebar:"code_tutorials_sidebar",previous:{title:"QTrobot Offline speech recognition",permalink:"/docs/tutorials/python/python_ros_vosk"},next:{title:"Create a ROS C++ project",permalink:"/docs/tutorials/cpp/cpp_ros_project"}},c={},d=[{value:"Preparation and requirements",id:"preparation-and-requirements",level:2},{value:"QTrobot setup",id:"qtrobot-setup",level:3},{value:"Your machine setup (QTPC)",id:"your-machine-setup-qtpc",level:3},{value:"Build the motors_moveit",id:"build-the-motors_moveit",level:2},{value:"How to run the examples",id:"how-to-run-the-examples",level:2},{value:"Drawing rectangle",id:"drawing-rectangle",level:3},{value:"Drawing spiral",id:"drawing-spiral",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.admonition,{title:"Overview",type:"info",children:[(0,o.jsxs)(n.p,{children:[(0,o.jsx)(i.Z,{children:"signal_cellular_alt"})," \xa0",(0,o.jsx)(n.strong,{children:"Level:"}),"\xa0 ",(0,o.jsx)(n.em,{children:"Advanced"}),"\n",(0,o.jsx)("br",{})," ",(0,o.jsx)(i.Z,{children:" track_changes "})," \xa0",(0,o.jsx)(n.strong,{children:"Goal:"}),"\xa0 ",(0,o.jsx)(n.em,{children:"learn how to control QTrobot arms using MoveIt"}),"\n",(0,o.jsx)("br",{})," ",(0,o.jsx)(i.Z,{children:" task_alt "})," \xa0",(0,o.jsx)(n.strong,{children:"Requirements:"})]}),(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\xa0\xa0",(0,o.jsx)(n.a,{href:"/docs/intro_code",children:"Quick start with coding on QTrobot"})]}),"\n",(0,o.jsxs)(n.li,{children:["\xa0\xa0",(0,o.jsx)(n.a,{href:"/docs/tutorials/python/python_ros_project",children:"Create a ROS python project"})]}),"\n"]})]}),"\n",(0,o.jsx)(n.p,{children:"This advanced tutorial demonstrate how to use ROS MoveIT to control QTrobot arms. The examples draw some shapes (i,e. rectangle and spirals) on the XY plane in robot frame."}),"\n",(0,o.jsx)("center",{children:(0,o.jsx)("iframe",{width:"800",height:"480",src:"https://www.youtube.com/embed/JVJMZNkcl6M",frameborder:"0",allow:"accelerometer; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:!0})}),"\n",(0,o.jsx)(n.h2,{id:"preparation-and-requirements",children:"Preparation and requirements"}),"\n",(0,o.jsx)(n.p,{children:"Before running the example, please ensure that following setups of your QTrobot and the machine which you are running the example."}),"\n",(0,o.jsx)(n.h3,{id:"qtrobot-setup",children:"QTrobot setup"}),"\n",(0,o.jsxs)(n.p,{children:["By default QTrobot motors interface runs in ",(0,o.jsx)(n.em,{children:"'normal'"})," mode. in normal mode, the motors control loop and joints state publisher run in low frequency (2-5Hz). More importantly the joint position values are in ",(0,o.jsx)(n.em,{children:"degree"}),". To be able to use MoveIt with QTrobot, you need to configure it to run in ",(0,o.jsx)(n.em,{children:"'advanced'"})," mode:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["joints position value is in ",(0,o.jsx)(n.em,{children:"radian"})]}),"\n",(0,o.jsx)(n.li,{children:"motors main controller loop and joints state publisher runs in 30hz."}),"\n",(0,o.jsxs)(n.li,{children:["required interfaces and controller such as ",(0,o.jsx)(n.code,{children:"robot_state_publisher"})," and ",(0,o.jsx)(n.code,{children:"JointTrajectoryController"})," are available"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Change motor launcher autostart script to run in advanced mode:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"nano ~/robot/autostart/start_qt_motor.sh\n"})}),"\n",(0,o.jsx)(n.p,{children:"and change the corresponding line to look like the following and save and exit:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"roslaunch qt_motor qt_motor_advanced.launch\n"})}),"\n",(0,o.jsx)(n.p,{children:"Reboot the robot to run the advance motor interface."}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Check the advanced mode setup:"}),"\nAfter rebooting the reboot, you can check (from QTPC, QTRP or your machine) if the motor interface is running in the advanced mode:"]}),"\n",(0,o.jsx)(n.p,{children:"joint state publisher frequency:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"rostopic hz /qt_robot/joints/state\n...\naverage rate: 30.041\n\tmin: 0.029s max: 0.047s std dev: 0.00391s window: 29\n"})}),"\n",(0,o.jsx)(n.p,{children:"joints value should be in radian:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"rostopic echo /qt_robot/joints/state\n...\nposition: [0.015707962851830046, 0.0, -0.6073745663782212, 1.569051024174513, -0.9896016991965904, -0.5689773095185405, -0.3455751785790718, -0.8360127383368947]\n"})}),"\n",(0,o.jsx)(n.p,{children:"trajectory controller is running:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"rostopic type  /qt_robot/left_arm_controller/follow_joint_trajectory/goal\n...\ncontrol_msgs/FollowJointTrajectoryActionGoal\n"})}),"\n",(0,o.jsx)(n.h3,{id:"your-machine-setup-qtpc",children:"Your machine setup (QTPC)"}),"\n",(0,o.jsx)(n.p,{children:"After checking and updating the QTrobot setup, you can install the iKfast solver plugin for MoveIt on the machine which you plan to run the example:"}),"\n",(0,o.jsx)(n.p,{children:"Get the latest version of QTrobot open software repository"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"cd ~/robot/code/software\ngit pull\n"})}),"\n",(0,o.jsx)(n.p,{children:"If the folder doesn't exists:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"cd ~/robot/code/\ngit clone https://github.com/luxai-qtrobot/software.git\n"})}),"\n",(0,o.jsx)(n.p,{children:"build the plugins:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"cd ~/catkin_ws/src\nln -s ~/software/plugins/qtrobot_ikfast_right_arm_plugin .\nln -s ~/software/plugins/qtrobot_ikfast_right_left_plugin .\ncd ~/catkin_ws\ncatkin_make\n"})}),"\n",(0,o.jsx)(n.h2,{id:"build-the-motors_moveit",children:"Build the motors_moveit"}),"\n",(0,o.jsxs)(n.p,{children:["Assuming that you already have the ",(0,o.jsx)(n.code,{children:"tutorial"})," repository (default path ",(0,o.jsx)(n.code,{children:"~/robot/code/tutorials"}),"):"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"cd ~/catkin_ws/src\nln -s ~/robot/code/tutorials/examples/motors_moveit ./\ncd ~/catkin_ws\ncatkin_make\n"})}),"\n",(0,o.jsx)(n.p,{children:"if you don't have it, then clone it and repeat the above process:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"git clone https://github.com/luxai-qtrobot/tutorials\n"})}),"\n",(0,o.jsx)(n.h2,{id:"how-to-run-the-examples",children:"How to run the examples"}),"\n",(0,o.jsxs)(n.p,{children:["Launch ",(0,o.jsx)(n.code,{children:"moveit_qtrobot.launch"})," to start move_group planner and rviz:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"roslaunch motors_moveit moveit_qtrobot.launch\n"})}),"\n",(0,o.jsx)(n.p,{children:"wait until rviz shows up, then run one of the following demos:"}),"\n",(0,o.jsx)(n.h3,{id:"drawing-rectangle",children:"Drawing rectangle"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"rosrun motors_moveit draw_rectangle.py joint_states:=/qt_robot/joints/state\n"})}),"\n",(0,o.jsx)(n.h3,{id:"drawing-spiral",children:"Drawing spiral"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"rosrun motors_moveit draw_spiral.py joint_states:=/qt_robot/joints/state\n"})})]})}function p(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}}}]);